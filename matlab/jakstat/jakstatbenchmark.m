load('totvar1','totvar1')
load('totvar2','totvar2')
load('totvar3','totvar3')
load('totvar4','totvar4')

mu1 = [1.000000000000000000e+00
7.897853718443836879e-01
6.242402018183289547e-01
4.937336843857673685e-01
3.907803027781557859e-01
3.095073516411829817e-01
2.453197803106876573e-01
1.945718418233598757e-01
1.544453942094144994e-01
1.226718423355959708e-01
9.749776261752936268e-02
7.754633130931894158e-02
6.172151513885758278e-02
4.916870187562925876e-02
3.919728810613678366e-02
3.127171776250149693e-02
2.497697676881439899e-02
1.996027962094680530e-02
1.597340324346754881e-02
1.280013238328448627e-02
1.027868995527107462e-02
8.277260509081211040e-03
6.686015013184240172e-03
5.434729951868028965e-03
4.453180278062360622e-03
3.687186047265381562e-03
3.098382489073092574e-03
2.650937878392805019e-03
2.324322660339986444e-03
2.093841358190976377e-03
1.946551190204340916e-03
1.869371822675385810e-03
1.851414567778845652e-03
1.884405862695187443e-03
1.961205406195185713e-03
2.076090183191317204e-03
2.226198248979824150e-03
2.405591051571357320e-03
2.615874704921048854e-03
2.851165383777949213e-03
3.110407071990256567e-03
3.392678121968035164e-03
3.696093838275525071e-03
4.016874975257177238e-03
4.355339823664464496e-03
4.711783224942061275e-03
5.081656340724270346e-03
5.469491639444430502e-03
5.871620261990773831e-03
6.283747416021678162e-03
6.711427758579534969e-03]';

mu2 = [0.000000000000000000e+00
2.101894353664625625e-01
3.647716652161258621e-01
4.623575266598202727e-01
5.125898349754391958e-01
5.292428049232843490e-01
5.247405524864938720e-01
5.080730854128371332e-01
4.850941316021499250e-01
4.593902522880751182e-01
4.330309164043982251e-01
4.071962411181285768e-01
3.825598072337834110e-01
3.594089291367874028e-01
3.378586761712580877e-01
3.179316261279775957e-01
2.995789313670708109e-01
2.826964773550253440e-01
2.671972903600762228e-01
2.529773975575007050e-01
2.399105876948245120e-01
2.279110373004236412e-01
2.168711318551369838e-01
2.067152284738503210e-01
1.973476866729113599e-01
1.887313232633723303e-01
1.807540627288563850e-01
1.733963254762977968e-01
1.665688477154000091e-01
1.602651479162394421e-01
1.544167120291480844e-01
1.489975172278634741e-01
1.439703174424063203e-01
1.392852546914474243e-01
1.349526770804175546e-01
1.309102931530588820e-01
1.271621763755333423e-01
1.236772356808166912e-01
1.204530123129680108e-01
1.174706797188920931e-01
1.147023529987560714e-01
1.121389648260739252e-01
1.097830564110756774e-01
1.076098156268647660e-01
1.056269910726916061e-01
1.038155549602843564e-01
1.021732052173375815e-01
1.006984664490058190e-01
9.937695471066762543e-02
9.820245813944636359e-02
9.715859903397640329e-02]';

mu3 = [0.000000000000000000e+00
0.000000000000000000e+00
5.486603550888194056e-03
2.189509335776248372e-02
4.801836889138493686e-02
7.979788309050800388e-02
1.132869958160334090e-01
1.457734876240377175e-01
1.757766629000528935e-01
2.026380527754422511e-01
2.262300922481280396e-01
2.467059425910849424e-01
2.642899811052160652e-01
2.793383531951439958e-01
2.921104277534786742e-01
3.029283586489763258e-01
3.120429966086177842e-01
3.196765594103289643e-01
3.260400096153299176e-01
3.312739890096840223e-01
3.355600992883318034e-01
3.390026125794355916e-01
3.417314126245368788e-01
3.438389448286882089e-01
3.453936845872102590e-01
3.464407538680386311e-01
3.471076521826079175e-01
3.473805377416876450e-01
3.473288775444613452e-01
3.470135344811006717e-01
3.464634678660757361e-01
3.457133127278217422e-01
3.447164191235777553e-01
3.435592309218625795e-01
3.422410960801053337e-01
3.408207762859267742e-01
3.392890864881796809e-01
3.376323953972519831e-01
3.358826776608946352e-01
3.340644039245055374e-01
3.322177774300408837e-01
3.302870052844741888e-01
3.282973582177627359e-01
3.262354548255357312e-01
3.241557079570544508e-01
3.220516952873452854e-01
3.199454995841335414e-01
3.178050638723231569e-01
3.156481905582049219e-01
3.134892089365627355e-01
3.113374195831868363e-01]';

mu4 = [0.000000000000000000e+00
0.000000000000000000e+00
0.000000000000000000e+00
5.848719385246816679e-05
2.920571903957229769e-04
8.038556879849438836e-04
1.654331610400416180e-03
2.860671423740127582e-03
4.414125780680727175e-03
6.284155424070835341e-03
8.441455839999454161e-03
1.085657067409775273e-02
1.348534543574013769e-02
1.630284378620487640e-02
1.928281810382606945e-02
2.239411468095546531e-02
2.561634647030607698e-02
2.892973640629779158e-02
3.232910077525065484e-02
3.579642806999364102e-02
3.930591703716823648e-02
4.286195798651871308e-02
4.644664026395043527e-02
5.004878295277342959e-02
5.366697988993057722e-02
5.729481656920090704e-02
6.091873539789856989e-02
6.453813049970939797e-02
6.814029176569888491e-02
7.172043065689999441e-02
7.527866998843660284e-02
7.881219602699397753e-02
8.230158321891520301e-02
8.577019632928818693e-02
8.920249961978672648e-02
9.258756058578235248e-02
9.593617857144910721e-02
9.923267744807015567e-02
1.024751818870986431e-01
1.056539618740071490e-01
1.087866061174645460e-01
1.118698442428378986e-01
1.148876359812466968e-01
1.178427190398290414e-01
1.207176779142120071e-01
1.235341791213209195e-01
1.262688549542370642e-01
1.289682796617701022e-01
1.315809125152931636e-01
1.341212314900459834e-01
1.365827113379989299e-01]';

var1 = [0.000000000000000000e+00
4.490461191243497446e-04
1.116859730654822013e-03
1.568609960199546282e-03
1.749514741435797714e-03
1.715264956814330005e-03
1.555143432171646493e-03
1.334122307922118444e-03
1.102663920432109907e-03
8.842680867573938152e-04
6.934732913599350995e-04
5.340027721714577435e-04
4.052957360315700172e-04
3.042293125695852765e-04
2.265567166545354833e-04
1.669357757528582725e-04
1.223464728844429045e-04
8.898921537866264289e-05
6.453984354770854524e-05
4.653797554442471335e-05
3.338078419704754477e-05
2.394074618712216344e-05
1.707693593857605827e-05
1.218528427710602022e-05
8.689390293217399920e-06
6.177898748731610179e-06
4.376164835821040201e-06
3.108758418991575233e-06
2.195463809822678520e-06
1.544281194525306486e-06
1.101012967636643145e-06
7.803094219957342874e-07
5.551767896779665188e-07
4.020272569324784608e-07
2.929609093520423109e-07
2.158054315459539422e-07
1.650717228004730100e-07
1.321878320838590328e-07
1.101420128618305318e-07
9.766169794352829451e-08
8.983312327772539167e-08
8.721258453842446154e-08
9.002974206590409658e-08
9.524347766524338242e-08
1.018173348511208590e-07
1.125712958385425081e-07
1.244950078765032382e-07
1.391099295251679581e-07
1.545831558962986152e-07
1.747474619669698490e-07
1.946145320756041184e-07]';

var2 = [0.000000000000000000e+00
4.433319402036014307e-04
9.691026784655204247e-04
1.030680437822889236e-03
7.978211713368210233e-04
5.636466049041347071e-04
4.408844459056716555e-04
4.142285892003119588e-04
4.379972491640456525e-04
4.793890490504821959e-04
5.177555358837995260e-04
5.449511229062031260e-04
5.582327031555704222e-04
5.590951396119933116e-04
5.506811990528353261e-04
5.349912510658439650e-04
5.135906341062841576e-04
4.883372019917139742e-04
4.619516580535112547e-04
4.348482380327371786e-04
4.080440813090262285e-04
3.821723112572460645e-04
3.568369306562897410e-04
3.331363435177573610e-04
3.100364587822961948e-04
2.890151515665600264e-04
2.690672876248138899e-04
2.510830865170183028e-04
2.340411519093939360e-04
2.181601243120190239e-04
2.039374734632831828e-04
1.906513213401984973e-04
1.787382445533012296e-04
1.676285362693463819e-04
1.570121921523241022e-04
1.479072340942607321e-04
1.390108943988550936e-04
1.309154154899504717e-04
1.234629548295243301e-04
1.166673598288496858e-04
1.100968026833666846e-04
1.040301974974536855e-04
9.851140652189385814e-05
9.328256450572400456e-05
8.849742822687858878e-05
8.428618435690196295e-05
8.023548410058075524e-05
7.613052287033287798e-05
7.253774794093397317e-05
6.924283032577792721e-05
6.586770114593055189e-05]';

var3 = [0.000000000000000000e+00
0.000000000000000000e+00
1.504802036411960141e-06
1.944547169348593107e-05
7.311368055540605915e-05
1.549688984982994005e-04
2.372464689825546800e-04
2.998918564749377845e-04
3.351092684021973788e-04
3.447999688324501549e-04
3.356291140902532442e-04
3.147707560400583274e-04
2.876681888275159447e-04
2.587732730102125381e-04
2.306777275809251829e-04
2.041032669663971706e-04
1.799802251715249750e-04
1.589863482175860715e-04
1.407081003075451970e-04
1.249741697732143940e-04
1.114157265966260631e-04
1.003531144838330780e-04
9.123803701509922029e-05
8.353857282599215094e-05
7.711249930218662179e-05
7.184395742724858987e-05
6.766840465112817387e-05
6.461623399472598607e-05
6.166209368990057120e-05
5.952955609177990233e-05
5.828733770810538286e-05
5.741685689081750543e-05
5.609961872356180489e-05
5.550704271335836531e-05
5.507984244159222004e-05
5.442049482446234022e-05
5.427010248899512859e-05
5.391389184543926593e-05
5.404279782004102483e-05
5.444704840242946671e-05
5.466015531091585652e-05
5.438288958301146361e-05
5.488922273772787509e-05
5.524301254866381515e-05
5.538537143051735069e-05
5.537017835544748333e-05
5.563448083747288888e-05
5.611863607397170594e-05
5.642163983390976621e-05
5.646192149716877992e-05
5.694503808531688037e-05]';

var4 = [0.000000000000000000e+00
0.000000000000000000e+00
0.000000000000000000e+00
1.709990822888949526e-10
3.920338080101744308e-09
2.457120773215742104e-08
8.598623954260445533e-08
2.133243899045424807e-07
4.251587563451760546e-07
7.279023049688286019e-07
1.113916519387077259e-06
1.591490687152429001e-06
2.137653720902438354e-06
2.748606919257383283e-06
3.385461059372001953e-06
4.067585619488874653e-06
4.754798156607365261e-06
5.434992448103558438e-06
6.167530510041672071e-06
6.886497334568130317e-06
7.590388191439015732e-06
8.304777988266855900e-06
9.002013704595907275e-06
9.690321217793893899e-06
1.040024047419409764e-05
1.106748209127193301e-05
1.171779520785164244e-05
1.241706231249186162e-05
1.303307494193158572e-05
1.366136597198823725e-05
1.439266596445958913e-05
1.504609363065876103e-05
1.562482749637350817e-05
1.630288552885838512e-05
1.697306160187355027e-05
1.756949658043794056e-05
1.827040550410373112e-05
1.881731719975360484e-05
1.950274686679132023e-05
2.021675941816205021e-05
2.087617926203820168e-05
2.156112670533497772e-05
2.215197590137831920e-05
2.287880420406500535e-05
2.354016135676113147e-05
2.423033738197358887e-05
2.483893739438310222e-05
2.556728557070060885e-05
2.632768189391808102e-05
2.713470003247099406e-05
2.773850733579132240e-05]';

t = [0:.1:5];

error1 = ((abs(totvar1 - var1))./(mu1))*100;
error2 = ((abs(totvar2 - var2))./(mu2))*100;
error3 = ((abs(totvar3 - var3))./(mu3))*100;
error4 = ((abs(totvar4 - var4))./(mu4))*100;

error2(1) = 0;
error3(1:2) = 0;
error4(1:3) = 0;

figure
hold on 
plot(t,error1); plot(t,error2); plot(t,error3); plot(t,error4)
xlabel('Time'); ylabel('Coefficient of Variation (%)')
title('Coefficient of Variation for JAK/STAT Model')
legend('x1','x2','x3','x4')

rmse1 = sqrt(mean((totvar1 - var1).^2));
rmse2 = sqrt(mean((totvar2 - var2).^2));
rmse3 = sqrt(mean((totvar3 - var3).^2));
rmse4 = sqrt(mean((totvar4 - var4).^2));

figure
subplot(1,2,1)
hold on 
plot(t,var1), plot(t,totvar1)
xlabel('Time'); ylabel('x_{1} Variance')
legend('Monte Carlo Simulation','Nonintrusive gPC + EKF')
set(gca,'fontsize',13)

subplot(1,2,2)
hold on 
plot(t,var2), plot(t,totvar2)
xlabel('Time'); ylabel('x_{2} Variance')
legend('Monte Carlo Simulation','Nonintrusive gPC + EKF')
set(gca,'fontsize',13)

% subplot(2,2,3)
% hold on 
% plot(t,var3), plot(t,totvar3)
% xlabel('Time'); ylabel('x_{3} Variance')
% legend('Monte Carlo Simulation','Nonintrusive gPC + EKF')
% set(gca,'fontsize',11.5)
% 
% subplot(2,2,4)
% hold on 
% plot(t,var4), plot(t,totvar4)
% xlabel('Time'); ylabel('x_{4} Variance')
% legend('Monte Carlo Simulation','Nonintrusive gPC + EKF')
% set(gca,'fontsize',11.5)